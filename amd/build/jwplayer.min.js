define(["jwplayer","jquery","core/config","core/yui","core/log","module"],function(a,b,c,d,e,f){var g=null,h=function(a){var b=this,f={method:"POST",data:{sesskey:c.sesskey,event:JSON.stringify(a),id:g,title:b.getPlaylistItem().title,file:b.getPlaylistItem().file,position:b.getPosition(),bitrate:b.getCurrentQuality().bitrate},on:{failure:function(a){e.error(a)}}};"play"==a.type&&setTimeout(function(){f.data.position=b.getPosition()},10),"levelsChanged"==a.type&&(f.data.qualitylevel=JSON.stringify(b.getQualityLevels())),"audioTrackChanged"==a.type&&(f.data.audiotracks=JSON.stringify(b.getAudioTracks())),"captionsChanged"==a.type&&(f.data.captions=JSON.stringify(b.getCaptionsList())),d.io(c.wwwroot+"/filter/jwplayer/eventlogger.php",f)},i=function(a){var b=this.getPlaylistItem().title+" "+a.type+": "+a.message;e.error(b)};return{setupPlayer:function(c){if(window.jwplayer=window.jwplayer||a,f.config().licensekey&&(window.jwplayer.key=f.config().licensekey),g=c.logcontext,b("#"+c.playerid).length){var d=a(c.playerid);d.setup(c.setupdata),"undefined"!=typeof c.downloadbtn&&d.addButton(c.downloadbtn.img,c.downloadbtn.tttext,function(){window.open(d.getPlaylistItem().file+"?forcedownload=true")},"download"),d.on("setupError",i),d.on("error",i),c.logevents.forEach(function(a){d.on(a,h)})}}}});